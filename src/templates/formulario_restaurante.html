<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración del restaurante</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/formulario_restaurante.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="form-container">
        <!-- Botón de cierre -->
        <a href="{{ url_for('gestion_restaurante') }}" class="btn-cerrar" aria-label="Cerrar formulario">
            <i class="fas fa-times"></i>
        </a>

        <h1>
            <i class="fas fa-utensils"></i> {% if restaurante %}Editar{% else %}Nueva{% endif %} Configuración del Restaurante
        </h1>
        
        <form id="restauranteForm" method="POST" action="{{ url_for('guardar_restaurante') }}">
            <!-- Campo oculto para el ID -->
            <input type="hidden" name="id" value="{{ restaurante.ID if restaurante else '' }}">

            <!-- Sección: Información General -->
            <div class="form-section">
                <h2><i class="fas fa-building"></i> Información General</h2>

                <div class="form-group">
                    <label for="Nombre_Restaurante">Nombre del restaurante*</label>
                    <input 
                        type="text" 
                        id="Nombre_Restaurante" 
                        name="Nombre_Restaurante" 
                        value="{{ restaurante.Nombre_Restaurante if restaurante else '' }}" 
                        required 
                        maxlength="100"
                        pattern="[A-Za-z0-9áéíóúÁÉÍÓÚñÑ\s.,'-]+"
                        title="Solo letras, números y caracteres comunes (.,'-)"
                    />
                </div>

                <div class="form-group">
                    <label for="Direccion">Dirección*</label>
                    <textarea 
                        id="Direccion" 
                        name="Direccion" 
                        rows="3" 
                        required
                        maxlength="250"
                    >{{ restaurante.Direccion if restaurante else '' }}</textarea>
                </div>
            </div>

            <!-- Sección: Contacto -->
            <div class="form-section">
                <h2><i class="fas fa-phone"></i> Contacto</h2>

                <div class="form-group">
                    <label>Teléfono*</label>
                    <div class="phone-input-group">
                        <select id="codigo_pais" name="codigo_pais" required>
                            <option value="" data-prefix="">Seleccionar país</option>
                            <!-- América -->
                            <optgroup label="América">
                                <option value="1" data-prefix="+1" {% if restaurante and restaurante.Telefono.startswith('+1') %}selected{% endif %}>Estados Unidos/Canadá (+1)</option>
                                <option value="52" data-prefix="+52" {% if restaurante and restaurante.Telefono.startswith('+52') %}selected{% endif %}>México (+52)</option>
                                <option value="54" data-prefix="+54" {% if restaurante and restaurante.Telefono.startswith('+54') %}selected{% endif %}>Argentina (+54)</option>
                                <option value="55" data-prefix="+55" {% if restaurante and restaurante.Telefono.startswith('+55') %}selected{% endif %}>Brasil (+55)</option>
                                <option value="56" data-prefix="+56" {% if restaurante and restaurante.Telefono.startswith('+56') %}selected{% endif %}>Chile (+56)</option>
                                <option value="57" data-prefix="+57" {% if restaurante and restaurante.Telefono.startswith('+57') %}selected{% endif %}>Colombia (+57)</option>
                                <option value="58" data-prefix="+58" {% if restaurante and restaurante.Telefono.startswith('+58') %}selected{% endif %}>Venezuela (+58)</option>
                                <option value="51" data-prefix="+51" {% if restaurante and restaurante.Telefono.startswith('+51') %}selected{% endif %}>Perú (+51)</option>
                                <option value="593" data-prefix="+593" {% if restaurante and restaurante.Telefono.startswith('+593') %}selected{% endif %}>Ecuador (+593)</option>
                                <option value="502" data-prefix="+502" {% if restaurante and restaurante.Telefono.startswith('+502') %}selected{% endif %}>Guatemala (+502)</option>
                            </optgroup>
                            <!-- Europa -->
                            <optgroup label="Europa">
                                <option value="34" data-prefix="+34" {% if restaurante and restaurante.Telefono.startswith('+34') %}selected{% endif %}>España (+34)</option>
                                <option value="33" data-prefix="+33" {% if restaurante and restaurante.Telefono.startswith('+33') %}selected{% endif %}>Francia (+33)</option>
                                <option value="49" data-prefix="+49" {% if restaurante and restaurante.Telefono.startswith('+49') %}selected{% endif %}>Alemania (+49)</option>
                                <option value="39" data-prefix="+39" {% if restaurante and restaurante.Telefono.startswith('+39') %}selected{% endif %}>Italia (+39)</option>
                                <option value="44" data-prefix="+44" {% if restaurante and restaurante.Telefono.startswith('+44') %}selected{% endif %}>Reino Unido (+44)</option>
                            </optgroup>
                            <!-- Asia -->
                            <optgroup label="Asia">
                                <option value="86" data-prefix="+86" {% if restaurante and restaurante.Telefono.startswith('+86') %}selected{% endif %}>China (+86)</option>
                                <option value="81" data-prefix="+81" {% if restaurante and restaurante.Telefono.startswith('+81') %}selected{% endif %}>Japón (+81)</option>
                                <option value="82" data-prefix="+82" {% if restaurante and restaurante.Telefono.startswith('+82') %}selected{% endif %}>Corea del Sur (+82)</option>
                            </optgroup>
                        </select>
                        <input 
                            type="tel" 
                            id="telefono" 
                            name="telefono" 
                            pattern="[0-9]{7,15}" 
                            value="{% if restaurante %}{{ restaurante.Telefono.split(' ')[1] if restaurante.Telefono else '' }}{% endif %}" 
                            placeholder="Número local" 
                            required
                            title="Solo números, 7 a 15 dígitos"
                        />
                    </div>
                    <input type="hidden" id="Telefono" name="Telefono" value="{{ restaurante.Telefono if restaurante else '' }}">
                </div>

                <div class="form-group">
                    <label for="Correo_Contacto">Correo de contacto*</label>
                    <input 
                        type="email" 
                        id="Correo_Contacto" 
                        name="Correo_Contacto" 
                        value="{{ restaurante.Correo_Contacto if restaurante else '' }}" 
                        required 
                        maxlength="50" 
                        pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                        title="Formato de correo válido"
                    />
                    <div class="error-message" id="email-error"></div>
                </div>
            </div>

            <!-- Sección: Horarios -->
            <div class="form-section">
                <h2><i class="fas fa-clock"></i> Horarios</h2>

                <div class="form-group">
                    <label for="Horario_Apertura">Horario de Apertura*</label>
                    <input 
                        type="time" 
                        id="Horario_Apertura" 
                        name="Horario_Apertura" 
                        value="{{ restaurante.Horario_Apertura if restaurante else '08:00' }}" 
                        required 
                    />
                </div>

                <div class="form-group">
                    <label for="Horario_Cierre">Horario de Cierre*</label>
                    <input 
                        type="time" 
                        id="Horario_Cierre" 
                        name="Horario_Cierre" 
                        value="{{ restaurante.Horario_Cierre if restaurante else '22:00' }}" 
                        required 
                    />
                </div>
            </div>

            <!-- Sección: Moneda e Impuestos -->
            <div class="form-section">
                <h2><i class="fas fa-dollar-sign"></i> Moneda e Impuestos</h2>

                <div class="form-group">
                    <label>Moneda*</label>
                    <div class="currency-input-group">
                        <select id="tipo_moneda" name="tipo_moneda" required>
                            <option value="">Seleccionar moneda</option>
                            <optgroup label="Principales">
                                <option value="USD" {% if restaurante and restaurante.Moneda == 'USD' %}selected{% endif %}>Dólar Estadounidense (USD)</option>
                                <option value="EUR" {% if restaurante and restaurante.Moneda == 'EUR' %}selected{% endif %}>Euro (EUR)</option>
                                <option value="JPY" {% if restaurante and restaurante.Moneda == 'JPY' %}selected{% endif %}>Yen Japonés (JPY)</option>
                                <option value="GBP" {% if restaurante and restaurante.Moneda == 'GBP' %}selected{% endif %}>Libra Esterlina (GBP)</option>
                            </optgroup>
                            <optgroup label="América">
                                <option value="MXN" {% if restaurante and restaurante.Moneda == 'MXN' %}selected{% endif %}>Peso Mexicano (MXN)</option>
                                <option value="BRL" {% if restaurante and restaurante.Moneda == 'BRL' %}selected{% endif %}>Real Brasileño (BRL)</option>
                                <option value="COP" {% if restaurante and restaurante.Moneda == 'COP' %}selected{% endif %}>Peso Colombiano (COP)</option>
                                <option value="CLP" {% if restaurante and restaurante.Moneda == 'CLP' %}selected{% endif %}>Peso Chileno (CLP)</option>
                                <option value="PEN" {% if restaurante and restaurante.Moneda == 'PEN' %}selected{% endif %}>Sol Peruano (PEN)</option>
                                <option value="ARS" {% if restaurante and restaurante.Moneda == 'ARS' %}selected{% endif %}>Peso Argentino (ARS)</option>
                            </optgroup>
                            <optgroup label="Otras">
                                <option value="CAD" {% if restaurante and restaurante.Moneda == 'CAD' %}selected{% endif %}>Dólar Canadiense (CAD)</option>
                                <option value="AUD" {% if restaurante and restaurante.Moneda == 'AUD' %}selected{% endif %}>Dólar Australiano (AUD)</option>
                                <option value="CNY" {% if restaurante and restaurante.Moneda == 'CNY' %}selected{% endif %}>Yuan Chino (CNY)</option>
                            </optgroup>
                        </select>
                        <input 
                            type="text" 
                            id="simbolo_moneda" 
                            name="simbolo_moneda" 
                            readonly 
                            class="readonly-input" 
                            value="{{ restaurante.simbolo_moneda if restaurante else '' }}"
                        />
                    </div>
                </div>

                <div class="form-group">
                    <label for="Impuesto">Impuesto (%)*</label>
                    <input 
                        type="number" 
                        id="Impuesto" 
                        name="Impuesto" 
                        step="0.01" 
                        min="0" 
                        max="100" 
                        value="{{ restaurante.Impuesto if restaurante else '10.00' }}" 
                        required
                    />
                </div>
            </div>

            <!-- Sección: Reservas y Política -->
            <div class="form-section">
                <h2><i class="fas fa-calendar-check"></i> Reservas y Política</h2>

                <div class="form-group">
                    <label for="Tiempo_Reserva_Min">Tiempo mínimo de reserva (minutos)*</label>
                    <input 
                        type="number" 
                        id="Tiempo_Reserva_Min" 
                        name="Tiempo_Reserva_Min" 
                        min="1" 
                        value="{{ restaurante.Tiempo_Reserva_Min if restaurante else '30' }}" 
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="Politica_Cancelacion">Política de Cancelación*</label>
                    <textarea 
                        id="Politica_Cancelacion" 
                        name="Politica_Cancelacion" 
                        rows="4" 
                        required
                    >{{ restaurante.Politica_Cancelacion if restaurante else '' }}</textarea>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Guardar Configuración
                </button>
            </div>
        </form>
    </div>

    <script src="{{ url_for('static', filename='js/formulario_restaurante.js') }}" defer></script>
</body>
</html>
